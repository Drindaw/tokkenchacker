import base64
exec(base64.b64decode(b'aW1wb3J0IHJlcXVlc3RzCmltcG9ydCB0aW1lCmltcG9ydCBvcwpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBTdHlsZSwgaW5pdApmcm9tIHBsYXRmb3JtIGltcG9ydCBzeXN0ZW0KCiMgSW5pdGlhbGl6ZSBjb2xvcmFtYQppbml0KGF1dG9yZXNldD1UcnVlKQoKIyBDbGVhciB0aGUgdGVybWluYWwgYmFzZWQgb24gT1MKZGVmIGNscygpOgogICAgaWYgc3lzdGVtKCkgPT0gJ0xpbnV4JyBvciBzeXN0ZW0oKSA9PSAnRGFyd2luJzoKICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgIGVsaWYgc3lzdGVtKCkgPT0gJ1dpbmRvd3MnOgogICAgICAgIG9zLnN5c3RlbSgnY2xzJykKCiMgQ29uc3RhbnRzIGZvciBjb2xvcnMgYW5kIGZvcm1hdHRpbmcKQ0xFQVJfU0NSRUVOID0gJ1wwMzNbMkonClJFRCA9ICdcMDMzWzE7MzFtJwpSRVNFVCA9ICdcMDMzWzBtJwpCTFVFID0gIlwwMzNbMTszNG0iCldISVRFID0gIlwwMzNbMTszN20iCllFTExPVyA9ICJcMDMzWzE7MzNtIgpDWUFOID0gIlwwMzNbMTszNm0iCk1BR0VOVEEgPSAiXDAzM1sxOzM1bSIKR1JFRU4gPSAiXDAzM1sxOzMybSIKQk9MRCA9ICdcMDMzWzE7MW0nCgpjbHMoKQp0aW1lLnNsZWVwKDEpCm9zLnN5c3RlbSgnY2xlYXInKQpsb2dvID0gKCIiIgobWzE7NzBt4paI4paI4pWXICAgIOKWiOKWiOKVlyDilojilojilojilojilojilZcg4paI4paI4pWXICAgICDilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilZcgChtbMTs3MG3ilojilojilZEgICAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWRICAgICDilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZcKG1sxOzkxbeKWiOKWiOKVkSDilojilZcg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWRICDilojilojilZEKG1sxOzkzbeKWiOKWiOKVkeKWiOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4pWU4pWQ4pWQ4pWdICDilojilojilZTilZDilZDilZ0gIOKWiOKWiOKVkSAg4paI4paI4pWRChtbMTs4MG3ilZrilojilojilojilZTilojilojilojilZTilZ3ilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnQogG1sxOzgwbeKVmuKVkOKVkOKVneKVmuKVkOKVkOKVnSDilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVnSAKIFwwMzNbMTszM208POKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkD4+ClwwMzNbMTszM21bKl0gXDAzM1sxOzkzbfCdkI7wnZCW8J2QjfCdkITwnZCRICAgICAgICAgICAgIFwwMzNbMTszM23ilIHilrcgXDAzM1sxOzkzbVdBTEVFRCBYRCAgICAgICAgICAgIFwwMzNbMTszM21bKl0KXDAzM1sxOzMzbVsqXSBcMDMzWzE7OTNt8J2QhvCdkIjwnZCT8J2Qh/CdkJTwnZCBICAgICAgICAgICAgXDAzM1sxOzMzbeKUgeKWtyBcMDMzWzE7OTNtV0FMRUVEWDQuMCAgICAgICAgICAgXDAzM1sxOzMzbVsqXQpcMDMzWzE7MzNtWypdIFwwMzNbMTs5M23wnZCR8J2QlPCdkIvwnZCE8J2QlyAgICAgICAgICAgICBcMDMzWzE7MzNt4pSB4pa3IFwwMzNbMTs5M21XQUxFRUQg8J2Zk/CdmL8gMDA3ICAgICAgICBcMDMzWzE7MzNtWypdClwwMzNbMTszM21bKl0gXDAzM1sxOzkzbfCdkJPwnZCO8J2QjvCdkIsgICAgICAgICAgICAgIFwwMzNbMTszM23ilIHilrcgXDAzM1sxOzkzbfCdkJPwnZCO8J2QivCdkITwnZCNIPCdkILwnZCH8J2QhPCdkILwnZCK8J2QhPCdkJEgICAgICAgIFwwMzNbMTszM21bKl0KXDAzM1sxOzMzbVsqXSBcMDMzWzE7OTNt8J2QhfCdkIDwnZCC8J2QhPCdkIHwnZCO8J2QiiAgICAgICAgICAgXDAzM1sxOzMzbeKUgeKWtyBcMDMzWzE7OTNtV0FMRUVEWEQgICAgICAgICAgICAgXDAzM1sxOzMzbVsqXQpcMDMzWzE7MzNtPDzilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZA+PgoKIiIiICkKIyBQcmludCB0aGUgbG9nbwpwcmludChGb3JlLiBDWUFOICsgbG9nbyArICBTdHlsZS5SRVNFVF9BTEwpCgojIFN0YXJ0IHRpbWUKcHJpbnQoJ1x1MDAxYlszN20nICsgJ1x4MWJbMTszN209PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0+PicpCnByaW50KCJcMDMzWzkybVN0YXJ0IFRpbWU6IiwgdGltZS5zdHJmdGltZSgiJVktJW0tJWQgJUg6JU06JVMiKSkKcHJpbnQoJ1x1MDAxYlszN20nICsgJ1x4MWJbMTszN209PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0+PicpCgojIEZ1bmN0aW9uIHRvIGNoZWNrIGEgc2luZ2xlIHRva2VuCmRlZiBjaGVja19zaW5nbGVfdG9rZW4odG9rZW4pOgogICAgdXJsID0gZidodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49e3Rva2VufScKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICBkYXRhID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIHVzZXJfaWQgPSBkYXRhLmdldCgnaWQnKQogICAgICAgICAgICBuYW1lID0gZGF0YS5nZXQoJ25hbWUnKQogICAgICAgICAgICBlbWFpbCA9IGRhdGEuZ2V0KCdlbWFpbCcsICdFbWFpbCBub3QgYXZhaWxhYmxlJykKCiAgICAgICAgICAgIHJlc3VsdCA9ICgKICAgICAgICAgICAgICAgIGYie0NZQU59WytdIFVzZXIgSUQ6IHt1c2VyX2lkfVxuIgogICAgICAgICAgICAgICAgZiJ7Q1lBTn1bK10gTmFtZToge25hbWV9XG4iCiAgICAgICAgICAgICAgICBmIntDWUFOfVsrXSBFbWFpbDoge2VtYWlsfVxuIgogICAgICAgICAgICAgICAgZiJ7Q1lBTn1bK10gVG9rZW4gVmFsaWQ6IFllc3tSRVNFVH1cbiIKICAgICAgICAgICAgKQogICAgICAgICAgICBwcmludChyZXN1bHQpCiAgICAgICAgICAgIHNhdmVfcmVzdWx0KHJlc3VsdCkKICAgICAgICAgICAgc2F2ZV92YWxpZF90b2tlbih0b2tlbiwgdXNlcl9pZCwgbmFtZSwgZW1haWwpICAjIFNhdmUgdmFsaWQgdG9rZW4gZGV0YWlscwogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlc3VsdCA9IGYie1JFRH1bK10gRXJyb3I6IHtyZXNwb25zZS5zdGF0dXNfY29kZX1cblsrXSBUb2tlbiBFeHBpcmVkIG9yIEludmFsaWR7UkVTRVR9IgogICAgICAgICAgICBwcmludChyZXN1bHQpCiAgICAgICAgICAgIHNhdmVfcmVzdWx0KHJlc3VsdCkKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmVzdWx0ID0gZiJ7UkVEfVsrXSBOZXR3b3JrIEVycm9yOiB7ZX17UkVTRVR9IgogICAgICAgIHByaW50KHJlc3VsdCkKICAgICAgICBzYXZlX3Jlc3VsdChyZXN1bHQpCiAgICAgICAgcmV0dXJuIEZhbHNlCgojIEZ1bmN0aW9uIHRvIGNoZWNrIHRva2VucyBmcm9tIGEgZmlsZQpkZWYgY2hlY2tfdG9rZW5zX2Zyb21fZmlsZShmaWxlX3BhdGgpOgogICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgdG9rZW5zID0gZmlsZS5yZWFkKCkuc3BsaXRsaW5lcygpCgogICAgICAgIHRvdGFsX3Rva2VucyA9IGxlbih0b2tlbnMpCiAgICAgICAgdmFsaWRfdG9rZW5zID0gMAogICAgICAgIHByaW50KGYie01BR0VOVEF9WytdIFRvdGFsIHRva2VucyB0byBjaGVjazoge3RvdGFsX3Rva2Vuc317UkVTRVR9IikKCiAgICAgICAgZm9yIGluZGV4LCB0b2tlbiBpbiBlbnVtZXJhdGUodG9rZW5zLCBzdGFydD0xKToKICAgICAgICAgICAgcHJpbnQoZiJcbntDWUFOfVsrXSBDaGVja2luZyBUb2tlbiB7aW5kZXh9L3t0b3RhbF90b2tlbnN9OiB7dG9rZW5bOjEwXX0uLi57UkVTRVR9IikKICAgICAgICAgICAgaWYgY2hlY2tfc2luZ2xlX3Rva2VuKHRva2VuKToKICAgICAgICAgICAgICAgIHZhbGlkX3Rva2VucyArPSAxCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkgICMgUmF0ZSBsaW1pdGluZyB0byBhdm9pZCBBUEkgbGltaXRzCgogICAgICAgIHByaW50KGYiXG57R1JFRU59WytdIFRvdGFsIHZhbGlkIHRva2Vuczoge3ZhbGlkX3Rva2Vuc30ve3RvdGFsX3Rva2Vuc317UkVTRVR9IikKICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICBwcmludChmIntSRUR9WytdIEVycm9yOiBGaWxlIG5vdCBmb3VuZCBhdCB7ZmlsZV9wYXRofXtSRVNFVH0iKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYie1JFRH1bK10gRXJyb3I6IHtlfXtSRVNFVH0iKQoKIyBGdW5jdGlvbiB0byBnZXQgRmFjZWJvb2sgUGFnZSBBY2Nlc3MgVG9rZW4KZGVmIGdldF9wYWdlX3Rva2VuKHVzZXJfdG9rZW4pOgogICAgdXJsID0gZidodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92MTkuMC9tZS9hY2NvdW50cz9maWVsZHM9YWNjZXNzX3Rva2VuLG5hbWUsaWQmYWNjZXNzX3Rva2VuPXt1c2VyX3Rva2VufScKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwpCiAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICBkYXRhID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIHBhZ2VzID0gZGF0YS5nZXQoJ2RhdGEnLCBbXSkKICAgICAgICAgICAgaWYgbm90IHBhZ2VzOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7UkVEfVsrXSBObyBwYWdlcyBmb3VuZCBmb3IgdGhpcyB1c2VyLntSRVNFVH0iKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBwcmludChmIntDWUFOfVsrXSBQYWdlcyBtYW5hZ2VkIGJ5IHRoaXMgdXNlcjp7UkVTRVR9IikKICAgICAgICAgICAgZm9yIGluZGV4LCBwYWdlIGluIGVudW1lcmF0ZShwYWdlcywgc3RhcnQ9MSk6CiAgICAgICAgICAgICAgICBwcmludChmIntDWUFOfVt7aW5kZXh9XSBQYWdlIE5hbWU6IHtwYWdlLmdldCgnbmFtZScpfSIpCiAgICAgICAgICAgICAgICBwcmludChmIntDWUFOfVt7Mn1dIFBhZ2UgSUQ6IHtwYWdlLmdldCgnaWQnKX0iKQogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Q1lBTn1bezN9XSBQYWdlIFRva2VuOiB7cGFnZS5nZXQoJ2FjY2Vzc190b2tlbicpfXtSRVNFVH0iKQoKICAgICAgICAgICAgIyBTYXZlIHBhZ2UgdG9rZW5zIHRvIGEgZmlsZQogICAgICAgICAgICB3aXRoIG9wZW4oInBhZ2VfdG9rZW5zLnR4dCIsICJhIikgYXMgZmlsZToKICAgICAgICAgICAgICAgIGZvciBwYWdlIGluIHBhZ2VzOgogICAgICAgICAgICAgICAgICAgIGZpbGUud3JpdGUoCiAgICAgICAgICAgICAgICAgICAgICAgIGYiUGFnZSBOYW1lOiB7cGFnZS5nZXQoJ25hbWUnKX1cbiIKICAgICAgICAgICAgICAgICAgICAgICAgZiJQYWdlIElEOiB7cGFnZS5nZXQoJ2lkJyl9XG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYiUGFnZSBBY2Nlc3MgVG9rZW46IHtwYWdlLmdldCgnYWNjZXNzX3Rva2VuJyl9XG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYieyctJyAqIDQwfVxuIgogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgcHJpbnQoZiJ7R1JFRU59WytdIFBhZ2UgdG9rZW5zIHNhdmVkIHRvICdwYWdlX3Rva2Vucy50eHQnLntSRVNFVH0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYie1JFRH1bK10gRXJyb3I6IHtyZXNwb25zZS5zdGF0dXNfY29kZX1cblsrXSBGYWlsZWQgdG8gcmV0cmlldmUgcGFnZSB0b2tlbnMue1JFU0VUfSIpCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJ7UkVEfVsrXSBOZXR3b3JrIEVycm9yOiB7ZX17UkVTRVR9IikKCiMgRnVuY3Rpb24gdG8gc2F2ZSByZXN1bHRzIHRvIGEgZmlsZQpkZWYgc2F2ZV9yZXN1bHQocmVzdWx0KToKICAgIHdpdGggb3BlbigicmVzdWx0cy50eHQiLCAiYSIpIGFzIGZpbGU6CiAgICAgICAgZmlsZS53cml0ZShyZXN1bHQgKyAiXG5cbiIpCgojIEZ1bmN0aW9uIHRvIHNhdmUgdmFsaWQgdG9rZW5zIGFuZCB0aGVpciBkZXRhaWxzCmRlZiBzYXZlX3ZhbGlkX3Rva2VuKHRva2VuLCB1c2VyX2lkLCBuYW1lLCBlbWFpbCk6CiAgICB3aXRoIG9wZW4oInZhbGlkX3Rva2Vucy50eHQiLCAiYSIpIGFzIGZpbGU6CiAgICAgICAgZmlsZS53cml0ZSgKICAgICAgICAgICAgZiJUb2tlbjoge3Rva2VufVxuIgogICAgICAgICAgICBmIlVzZXIgSUQ6IHt1c2VyX2lkfVxuIgogICAgICAgICAgICBmIk5hbWU6IHtuYW1lfVxuIgogICAgICAgICAgICBmIkVtYWlsOiB7ZW1haWx9XG4iCiAgICAgICAgICAgIGYieyctJyAqIDQwfVxuIgogICAgICAgICkKCiMgTWFpbiBmdW5jdGlvbgpkZWYgbWFpbigpOgogICAgY2xzKCkKICAgIHByaW50KGxvZ28pCiAgICBwcmludChmIntZRUxMT1d9XG5bMV0gQ2hlY2sgU2luZ2xlIFRva2VuIikKICAgIHByaW50KGYie1lFTExPV31cblsyXSBDaGVjayBUb2tlbnMgZnJvbSBGaWxlIikKICAgIHByaW50KGYie1lFTExPV31cblszXSBHZXQgRmFjZWJvb2sgUGFnZSBBY2Nlc3MgVG9rZW57UkVTRVR9IikKICAgIGNob2ljZSA9IGlucHV0KGYie1dISVRFfVxuWytdIEVudGVyIHlvdXIgY2hvaWNlICgxLCAyLCBvciAzKToge1JFU0VUfSIpCgogICAgaWYgY2hvaWNlID09ICcxJzoKICAgICAgICB0b2tlbiA9IGlucHV0KGYie0NZQU59WytdIEVudGVyIHRoZSB0b2tlbiB0byBjaGVjazoge1JFU0VUfSIpCiAgICAgICAgY2hlY2tfc2luZ2xlX3Rva2VuKHRva2VuKQogICAgZWxpZiBjaG9pY2UgPT0gJzInOgogICAgICAgIGZpbGVfcGF0aCA9IGlucHV0KGYie0NZQU59WytdIEVudGVyIHRoZSBmaWxlIHBhdGggKGUuZy4sIHRva2Vucy50eHQpOiB7UkVTRVR9IikKICAgICAgICBjaGVja190b2tlbnNfZnJvbV9maWxlKGZpbGVfcGF0aCkKICAgIGVsaWYgY2hvaWNlID09ICczJzoKICAgICAgICB1c2VyX3Rva2VuID0gaW5wdXQoZiJ7Q1lBTn1bK10gRW50ZXIgeW91ciBGYWNlYm9vayBVc2VyIEFjY2VzcyBUb2tlbjoge1JFU0VUfSIpCiAgICAgICAgZ2V0X3BhZ2VfdG9rZW4odXNlcl90b2tlbikKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoZiJ7UkVEfVsrXSBJbnZhbGlkIGNob2ljZSEgUGxlYXNlIHNlbGVjdCAxLCAyLCBvciAzLntSRVNFVH0iKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQ=='))